{% extends "base.html" %}
{% load report_extras %}

{% block title %}Admin jadvali 1 {{ date|date:"d.m.Y" }}{% endblock %}

{% block content %}
<style>
  .t1a-panel{
    background: var(--surface);
    border: 1px solid var(--stroke);
    border-radius: 20px;
    box-shadow: var(--shadow);
    padding: 14px;
    backdrop-filter: blur(14px);
  }

  .t1a-topbar{
    display:flex;
    justify-content:space-between;
    align-items:flex-start;
    gap:12px;
    flex-wrap:wrap;
    margin-bottom:12px;
  }

  .t1a-titlebox h2{
    margin:0;
    font-size:20px;
    font-weight:950;
    letter-spacing:-.02em;
    color:var(--text);
  }
  .t1a-subtitle{
    margin-top:6px;
    color:var(--muted);
    font-size:13px;
    line-height:1.4;
  }

  .t1a-back{
    display:inline-flex;
    align-items:center;
    justify-content:center;
    gap:10px;
    height:44px;
    padding:0 14px;
    border-radius:14px;
    border:1px solid var(--stroke);
    background: rgba(255,255,255,.55);
    color:var(--text);
    text-decoration:none;
    font-weight:950;
    white-space:nowrap;
    box-shadow: 0 14px 34px rgba(15,23,42,.08);
    transition:transform .12s ease, box-shadow .12s ease, filter .12s ease, background .12s ease;
    user-select:none;
  }
  html[data-theme="dark"] .t1a-back{ background: rgba(255,255,255,.06); }
  .t1a-back:hover{ transform: translateY(-1px); box-shadow: 0 18px 48px rgba(15,23,42,.12); filter:saturate(1.02); }
  .t1a-back:active{ transform: translateY(0); }

  .t1a-wrap{
    border:1px solid var(--stroke);
    border-radius:18px;
    overflow:hidden;
    background: rgba(255,255,255,.20);
  }
  html[data-theme="dark"] .t1a-wrap{ background: rgba(255,255,255,.04); }

  .t1a-hdr{
    font-weight:950;
    text-align:center;
    padding:12px 12px;
    border-bottom:1px solid var(--stroke);
    color:var(--text);
    background: rgba(255,255,255,.35);
  }
  html[data-theme="dark"] .t1a-hdr{ background: rgba(255,255,255,.06); }

  .t1a-scroll{
    overflow:auto;
    -webkit-overflow-scrolling: touch;
    max-width:100%;
  }
  .t1a-scroll::-webkit-scrollbar{ height: 10px; }
  .t1a-scroll::-webkit-scrollbar-thumb{ background: rgba(15,23,42,.22); border-radius: 999px; }
  html[data-theme="dark"] .t1a-scroll::-webkit-scrollbar-thumb{ background: rgba(255,255,255,.18); }

  :root{
    --t1a-grid: rgba(15,23,42,.22);
    --t1a-sticky-shadow: rgba(15,23,42,.12);
    --t1a-col-name: 190px;
    --t1a-col-shift: 74px;
  }
  html[data-theme="dark"]{
    --t1a-grid: rgba(255,255,255,.22);
    --t1a-sticky-shadow: rgba(0,0,0,.45);
  }

  table.t1a-table{
    border-collapse: separate;
    border-spacing: 0;
    min-width: 2180px;
    width: max-content;
    table-layout: fixed;
  }

  .t1a-table th, .t1a-table td{
    border-right:1px solid var(--t1a-grid);
    border-bottom:1px solid var(--t1a-grid);
    padding:6px 8px;
    font-size:12px;
    text-align:center;
    vertical-align:middle;
    color:var(--text);
    background:transparent;
  }

  .t1a-table thead tr:first-child th{ border-top:1px solid var(--t1a-grid); }
  .t1a-table tr > *:first-child{ border-left:1px solid var(--t1a-grid); }

  .t1a-table thead th{
    position:sticky;
    top:0;
    z-index:40;
    background: var(--surface);
    font-weight:950;
  }

  #t1admin col:nth-child(3),
  #t1admin col:nth-child(4){
    background: rgba(240, 149, 149, 0.18);
  }
  #t1admin col:nth-child(10),
  #t1admin col:nth-child(11){
    background: rgba(149, 250, 119, 0.18);
  }
  #t1admin col:nth-child(17),
  #t1admin col:nth-child(18){
    background: rgba(31, 112, 6, 0.445);
  }
  #t1admin col:nth-child(19){
    background: rgba(212, 199, 113, 0.89);
  }
  #t1admin col:nth-child(24),
  #t1admin col:nth-child(25){
    background: rgba(229, 246, 250, 0.904);
  }
  #t1admin col:nth-child(30),
  #t1admin col:nth-child(31){
    background: rgba(171, 229, 236, 0.904);
  }

  .t1a-vtxt{
    writing-mode: vertical-rl;
    transform: rotate(180deg);
    white-space: nowrap;
    font-weight: 900;
    line-height:1.05;
  }
 
  .t1a-name{
    width:var(--t1a-col-name);
    min-width:var(--t1a-col-name);
    max-width:var(--t1a-col-name);
    font-weight:950;
    text-align:left;
    padding-left:10px;
  }
  .t1a-shift{
    width:var(--t1a-col-shift);
    min-width:var(--t1a-col-shift);
    max-width:var(--t1a-col-shift);
    font-weight:950;
  }

  .t1a-stickyA{
    position:sticky;
    left:0;
    z-index:200;
    background: var(--surface);
    box-shadow: 10px 0 16px -14px var(--t1a-sticky-shadow);
  }
  .t1a-stickyB{
    position:sticky;
    left:var(--t1a-col-name);
    z-index:190;
    background: var(--surface);
    box-shadow: 10px 0 16px -14px var(--t1a-sticky-shadow);
  }
 
  .g-green{ background: rgba(34,197,94,.12); }
  .g-blue{ background: rgba(79,70,229,.12); }
  .g-yellow{ background: rgba(245,158,11,.14); }
  .g-gray{ background: rgba(100,116,139,.12); }

  html[data-theme="dark"] .g-green{ background: rgba(34,197,94,.08); }
  html[data-theme="dark"] .g-blue{ background: rgba(79,70,229,.08); }
  html[data-theme="dark"] .g-yellow{ background: rgba(245,158,11,.10); }
  html[data-theme="dark"] .g-gray{ background: rgba(100,116,139,.08); }

  .t1a-total td{
    background: rgba(255,244,204,.65);
    font-weight:950;
  }
  html[data-theme="dark"] .t1a-total td{
    background: rgba(255,244,204,.12);
  }
 
  .t1a-note{
    margin-top:10px;
    color:var(--muted);
    font-size:13px;
    line-height:1.45;
  }

  /* ‚úÖ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ (–∏ –≤—Å—è —è—á–µ–π–∫–∞) */
  .t1a-name.is-clickable{ cursor:pointer; }
  .t1a-stname-link{
    display:inline-block;
    position:relative;
    z-index: 9999;
    pointer-events:auto;
    color: var(--text);
    font-weight: 950;
    text-decoration: underline;
    text-underline-offset: 3px;
  }

 .t1a-table td{
  font-variant-numeric: tabular-nums;
  }
  .t1a-table tbody td{
    text-align: right;
  }
  .t1a-table tbody td.t1a-name,
  .t1a-table tbody td.t1a-shift{
    text-align: left;
  }
  .t1a-scroll{
    overflow: auto;                 /* gorizontal + vertikal */
    -webkit-overflow-scrolling: touch;
    max-width: 100%;

    /* ‚úÖ vertikal scroll uchun balandlik */
    max-height: calc(100vh - 260px); /* xohlasangiz 60vh / 70vh qilib ham qo'yasiz */
  }
  .t1a-table thead th{
    position: sticky;
    top: 0;
    z-index: 60;          /* header hamma narsadan ustun turadi */
    background: var(--surface);
  }
  /* Header ichidagi LM nomi va Smena: yuqoriga ham, chapga ham sticky bo'lsin */
  .t1a-table thead th.t1a-stickyA,
  .t1a-table thead th.t1a-stickyB{
    z-index: 120; /* eng ustun: header+left kesishmasi */
  }


</style>

<div class="t1a-panel">
  <div class="t1a-topbar">
    <div class="t1a-titlebox">
      <h2>
        <span data-i18n="t1_admin_title">Hisobot ‚Ññ1</span> ‚Äî {{ date|date:"d.m.Y" }}
      </h2>
      <div class="t1a-subtitle" data-i18n="t1_admin_sub">
        Logistika markazlari bo‚Äòyicha operativ ma‚Äôlumot (admin ko‚Äòrish).
      </div>
    </div>

    <a class="t1a-back" href="{% url 'admin_table1_reports' %}">
      <span aria-hidden="true">‚Üê</span>
      <span data-i18n="back_to_list">Ro‚Äòyxatga qaytish</span>
    </a>

    <a class="t1a-back" href="{% url 'admin_table1_export_excel' date|date:'Y-m-d' %}">
      üì• Excel
    </a>
  </div>

  <div class="t1a-wrap">
    <div class="t1a-hdr" data-i18n="t1_admin_header">
      –û–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–±–æ—Ç–µ –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö —Ü–µ–Ω—Ç—Ä–æ–≤ –ê–û "–£–∑—Ç–µ–º–∏—Ä–π—É–ª–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä" –≤ —Å—É—Ç–∫–∏ ‚Äî
      {{ date|date:"d.m.Y" }} ‚Äî –∫ 18:00 —á–∞—Å
    </div>

    <div class="t1a-scroll">
      <table class="t1a-table" id="t1admin">
        <colgroup>
          <col style="width:190px;">
          <col style="width:74px;">
          <col style="width:74px;">
          <col style="width:74px;">

          {% for _ in "1234567" %}<col style="width:74px;">{% endfor %}
          {% for _ in "1234567" %}<col style="width:74px;">{% endfor %}

          <col style="width:74px;">

          {% for _ in "123456" %}<col style="width:74px;">{% endfor %}
          {% for _ in "123456" %}<col style="width:74px;">{% endfor %}

          <col style="width:86px;">
        </colgroup>

        <thead>
          <tr>
            <th rowspan="2" class="t1a-name t1a-stickyA" data-i18n="col_lc">–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –õ–¶</th>
            <th rowspan="2" class="t1a-shift t1a-stickyB" data-i18n="col_shift">–°–º–µ–Ω–∞</th>

            <th style="background: rgba(238, 207, 207, 0.18);" rowspan="2"><div class="t1a-vtxt" data-i18n="t1_col_podano">–ü–æ–¥–∞–Ω–æ –Ω–∞ –õ–¶</div></th>
            <th style="background: rgba(238, 207, 207, 0.18);" rowspan="2"><div class="t1a-vtxt" data-i18n="t1_col_kpod">–∫ –ø–æ–¥–∞—á–µ —Å–æ —Å—Ç</div></th>

            <th style="background: rgba(149, 250, 119, 0.18);" colspan="7" class="g-green" data-i18n="t1_blk_vygr">–í—ã–≥—Ä—É–∑–∫–∞</th>
            <th style="background: rgba(39, 133, 10, 0.363);" colspan="7" class="g-green" data-i18n="t1_blk_pod_vygr">–ü–æ–¥ –≤—ã–≥—Ä—É–∑–∫–æ–π</th>

            <th style="background: rgb(236, 222, 160);" rowspan="2" class="g-yellow"><div class="t1a-vtxt" data-i18n="t1_col_uborka">–£–±–æ—Ä–∫–∞</div></th>

            <th style="background: rgba(229, 246, 250, 0.904);" colspan="6" class="g-blue" data-i18n="t1_blk_pogr">–ü–æ–≥—Ä—É–∑–∫–∞</th>
            <th style="background: rgba(171, 229, 236, 0.904);" colspan="6" class="g-blue" data-i18n="t1_blk_pod_pogr">–ü–æ–¥ –ø–æ–≥—Ä—É–∑–∫–æ–π</th>

            <th rowspan="2" class="g-gray"><div class="t1a-vtxt" data-i18n="t1_col_income">—Å—É—Ç–æ—á–Ω—ã–µ –¥–æ—Ö–æ–¥—ã</div></th>
          </tr>

          <tr>
            <th class="g-green"><div class="t1a-vtxt">—Ñ—Ç</div></th>
            <th class="g-green"><div class="t1a-vtxt">–∫–æ–Ω—Ç.</div></th>
            <th class="g-green"><div class="t1a-vtxt">–∫—Ä</div></th>
            <th class="g-green"><div class="t1a-vtxt">–ø–≤</div></th>
            <th class="g-green"><div class="t1a-vtxt" data-i18n="t1_misc">–ø—Ä–æ—á–µ–µ</div></th>
            <th style="background: rgba(209, 247, 197, 0.18);" class="g-green"><div class="t1a-vtxt" data-i18n="t1_itogo">–∏—Ç–æ–≥–æ</div></th>
            <th style="background: rgba(209, 247, 197, 0.18);" class="g-green"><div class="t1a-vtxt" data-i18n="t1_itogo_kon">–∏—Ç–æ–≥–æ –∫–æ–Ω</div></th>

            <th class="g-green"><div class="t1a-vtxt">—Ñ—Ç</div></th>
            <th class="g-green"><div class="t1a-vtxt">–∫–æ–Ω—Ç.</div></th>
            <th class="g-green"><div class="t1a-vtxt">–∫—Ä</div></th>
            <th class="g-green"><div class="t1a-vtxt">–ø–≤</div></th>
            <th class="g-green"><div class="t1a-vtxt" data-i18n="t1_misc">–ø—Ä–æ—á–µ–µ</div></th>
            <th style="background: rgba(39, 161, 1, 0.18);" class="g-green"><div class="t1a-vtxt" data-i18n="t1_itogo">–∏—Ç–æ–≥–æ</div></th>
            <th style="background: rgba(39, 161, 1, 0.18);" class="g-green"><div class="t1a-vtxt" data-i18n="t1_itogo_kon">–∏—Ç–æ–≥–æ –∫–æ–Ω</div></th>

            <th class="g-blue"><div class="t1a-vtxt">—Ñ—Ç</div></th>
            <th class="g-blue"><div class="t1a-vtxt">–∫–æ–Ω—Ç.</div></th>
            <th class="g-blue"><div class="t1a-vtxt">–∫—Ä</div></th>
            <th class="g-blue"><div class="t1a-vtxt">–ø–≤</div></th>
            <th style="background: rgba(229, 246, 250, 0.904);" class="g-blue"><div class="t1a-vtxt" data-i18n="t1_misc">–ø—Ä–æ—á–µ–µ</div></th>
            <th style="background: rgba(229, 246, 250, 0.904);" class="g-blue"><div class="t1a-vtxt" data-i18n="t1_itogo_kon">–∏—Ç–æ–≥–æ –∫–æ–Ω</div></th>

            <th class="g-blue"><div class="t1a-vtxt">—Ñ—Ç</div></th>
            <th class="g-blue"><div class="t1a-vtxt">–∫–æ–Ω—Ç.</div></th>
            <th class="g-blue"><div class="t1a-vtxt">–∫—Ä</div></th>
            <th class="g-blue"><div class="t1a-vtxt">–ø–≤</div></th>
            <th style="background: rgba(171, 229, 236, 0.904);" class="g-blue"><div class="t1a-vtxt" data-i18n="t1_misc">–ø—Ä–æ—á–µ–µ</div></th>
            <th style="background: rgba(171, 229, 236, 0.904);" class="g-blue"><div class="t1a-vtxt" data-i18n="t1_itogo_kon">–∏—Ç–æ–≥–æ –∫–æ–Ω</div></th>
          </tr>
        </thead>

        <tbody>
          {% for st in stations %}

            {# ‚úÖ –í–ê–ñ–ù–û: rowspan = 3 –µ—Å–ª–∏ –µ—Å—Ç—å –Ω–æ—á—å+–∏—Ç–æ–≥, –∏–Ω–∞—á–µ rowspan=1 (—Ç–æ–ª—å–∫–æ –¥–µ–Ω—å) #}
            <tr>
              <td rowspan="{% if st.status %}3{% else %}1{% endif %}"
                  class="t1a-name t1a-stickyA {% if st.status and st.blocks_url %}is-clickable{% endif %}"
                  {% if st.status and st.blocks_url %}data-href="{{ st.blocks_url }}"{% endif %}>

                {% if st.status and st.blocks_url %}
                  <a class="t1a-stname-link" href="{{ st.blocks_url }}" title="–û—Ç–∫—Ä—ã—Ç—å 3 –±–ª–æ–∫–∞ —Å—Ç–∞–Ω—Ü–∏–∏">
                    {{ st.name }}
                  </a>
                {% else %}
                  {{ st.name }}
                {% endif %}
              </td>

              <td class="t1a-shift t1a-stickyB" data-i18n="shift_day">–¥–µ–Ω—å</td>

              <td>{{ st.day_data|get_item:"podano_lc"|default_if_none:"0" }}</td>
              <td>{{ st.day_data|get_item:"k_podache_so_st"|default_if_none:"0" }}</td>

              <td class="g-green">{{ st.day_data|get_item:"vygr_ft"|default_if_none:"0" }}</td>
              <td class="g-green">{{ st.day_data|get_item:"vygr_cont"|default_if_none:"0" }}</td>
              <td class="g-green">{{ st.day_data|get_item:"vygr_kr"|default_if_none:"0" }}</td>
              <td class="g-green">{{ st.day_data|get_item:"vygr_pv"|default_if_none:"0" }}</td>
              <td class="g-green">{{ st.day_data|get_item:"vygr_proch"|default_if_none:"0" }}</td>
              <td class="g-green">{{ st.day_data|get_item:"vygr_itogo"|default_if_none:"0" }}</td>
              <td class="g-green">{{ st.day_data|get_item:"vygr_itogo_kon"|default_if_none:"0" }}</td>

              <td class="g-green">{{ st.day_data|get_item:"pod_vygr_ft"|default_if_none:"0" }}</td>
              <td class="g-green">{{ st.day_data|get_item:"pod_vygr_cont"|default_if_none:"0" }}</td>
              <td class="g-green">{{ st.day_data|get_item:"pod_vygr_kr"|default_if_none:"0" }}</td>
              <td class="g-green">{{ st.day_data|get_item:"pod_vygr_pv"|default_if_none:"0" }}</td>
              <td class="g-green">{{ st.day_data|get_item:"pod_vygr_proch"|default_if_none:"0" }}</td>
              <td class="g-green">{{ st.day_data|get_item:"pod_vygr_itogo"|default_if_none:"0" }}</td>
              <td class="g-green">{{ st.day_data|get_item:"pod_vygr_itogo_kon"|default_if_none:"0" }}</td>

              <td class="g-yellow">{{ st.day_data|get_item:"uborka"|default_if_none:"0" }}</td>

              <td class="g-blue">{{ st.day_data|get_item:"pogr_ft"|default_if_none:"0" }}</td>
              <td class="g-blue">{{ st.day_data|get_item:"pogr_cont"|default_if_none:"0" }}</td>
              <td class="g-blue">{{ st.day_data|get_item:"pogr_kr"|default_if_none:"0" }}</td>
              <td class="g-blue">{{ st.day_data|get_item:"pogr_pv"|default_if_none:"0" }}</td>
              <td class="g-blue">{{ st.day_data|get_item:"pogr_proch"|default_if_none:"0" }}</td>
              <td class="g-blue">{{ st.day_data|get_item:"pogr_itogo_kon"|default_if_none:"0" }}</td>

              <td class="g-blue">{{ st.day_data|get_item:"pod_pogr_ft"|default_if_none:"0" }}</td>
              <td class="g-blue">{{ st.day_data|get_item:"pod_pogr_cont"|default_if_none:"0" }}</td>
              <td class="g-blue">{{ st.day_data|get_item:"pod_pogr_kr"|default_if_none:"0" }}</td>
              <td class="g-blue">{{ st.day_data|get_item:"pod_pogr_pv"|default_if_none:"0" }}</td>
              <td class="g-blue">{{ st.day_data|get_item:"pod_pogr_proch"|default_if_none:"0" }}</td>
              <td class="g-blue">{{ st.day_data|get_item:"pod_pogr_itogo_kon"|default_if_none:"0" }}</td>

              <td class="g-gray">{{ st.day_data|get_item:"income_daily"|default_if_none:"0" }}</td>
            </tr>

            {# ‚úÖ –ù–æ—á—å –∏ –ò—Ç–æ–≥ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –¢–û–õ–¨–ö–û –µ—Å–ª–∏ status=True #}
            {% if st.status %}
            <tr>
              <td class="t1a-shift t1a-stickyB" data-i18n="shift_night">–Ω–æ—á—å</td>

              <td>{{ st.night_data|get_item:"podano_lc"|default_if_none:"0" }}</td>
              <td>{{ st.night_data|get_item:"k_podache_so_st"|default_if_none:"0" }}</td>

              <td class="g-green">{{ st.night_data|get_item:"vygr_ft"|default_if_none:"0" }}</td>
              <td class="g-green">{{ st.night_data|get_item:"vygr_cont"|default_if_none:"0" }}</td>
              <td class="g-green">{{ st.night_data|get_item:"vygr_kr"|default_if_none:"0" }}</td>
              <td class="g-green">{{ st.night_data|get_item:"vygr_pv"|default_if_none:"0" }}</td>
              <td class="g-green">{{ st.night_data|get_item:"vygr_proch"|default_if_none:"0" }}</td>
              <td class="g-green">{{ st.night_data|get_item:"vygr_itogo"|default_if_none:"0" }}</td>
              <td class="g-green">{{ st.night_data|get_item:"vygr_itogo_kon"|default_if_none:"0" }}</td>

              <td class="g-green">{{ st.night_data|get_item:"pod_vygr_ft"|default_if_none:"0" }}</td>
              <td class="g-green">{{ st.night_data|get_item:"pod_vygr_cont"|default_if_none:"0" }}</td>
              <td class="g-green">{{ st.night_data|get_item:"pod_vygr_kr"|default_if_none:"0" }}</td>
              <td class="g-green">{{ st.night_data|get_item:"pod_vygr_pv"|default_if_none:"0" }}</td>
              <td class="g-green">{{ st.night_data|get_item:"pod_vygr_proch"|default_if_none:"0" }}</td>
              <td class="g-green">{{ st.night_data|get_item:"pod_vygr_itogo"|default_if_none:"0" }}</td>
              <td class="g-green">{{ st.night_data|get_item:"pod_vygr_itogo_kon"|default_if_none:"0" }}</td>

              <td class="g-yellow">{{ st.night_data|get_item:"uborka"|default_if_none:"0" }}</td>

              <td class="g-blue">{{ st.night_data|get_item:"pogr_ft"|default_if_none:"0" }}</td>
              <td class="g-blue">{{ st.night_data|get_item:"pogr_cont"|default_if_none:"0" }}</td>
              <td class="g-blue">{{ st.night_data|get_item:"pogr_kr"|default_if_none:"0" }}</td>
              <td class="g-blue">{{ st.night_data|get_item:"pogr_pv"|default_if_none:"0" }}</td>
              <td class="g-blue">{{ st.night_data|get_item:"pogr_proch"|default_if_none:"0" }}</td>
              <td class="g-blue">{{ st.night_data|get_item:"pogr_itogo_kon"|default_if_none:"0" }}</td>

              <td class="g-blue">{{ st.night_data|get_item:"pod_pogr_ft"|default_if_none:"0" }}</td>
              <td class="g-blue">{{ st.night_data|get_item:"pod_pogr_cont"|default_if_none:"0" }}</td>
              <td class="g-blue">{{ st.night_data|get_item:"pod_pogr_kr"|default_if_none:"0" }}</td>
              <td class="g-blue">{{ st.night_data|get_item:"pod_pogr_pv"|default_if_none:"0" }}</td>
              <td class="g-blue">{{ st.night_data|get_item:"pod_pogr_proch"|default_if_none:"0" }}</td>
              <td class="g-blue">{{ st.night_data|get_item:"pod_pogr_itogo_kon"|default_if_none:"0" }}</td>

              <td class="g-gray">{{ st.night_data|get_item:"income_daily"|default_if_none:"0" }}</td>
            </tr>
 
            <tr class="t1a-total">
              <td class="t1a-shift t1a-stickyB" data-i18n="shift_total">–∏—Ç–æ–≥</td>

              <td><b>{{ st.total_data|get_item:"podano_lc"|default_if_none:"0" }}</b></td>
              <td><b>{{ st.total_data|get_item:"k_podache_so_st"|default_if_none:"0" }}</b></td>

              <td class="g-green"><b>{{ st.total_data|get_item:"vygr_ft"|default_if_none:"0" }}</b></td>
              <td class="g-green"><b>{{ st.total_data|get_item:"vygr_cont"|default_if_none:"0" }}</b></td>
              <td class="g-green"><b>{{ st.total_data|get_item:"vygr_kr"|default_if_none:"0" }}</b></td>
              <td class="g-green"><b>{{ st.total_data|get_item:"vygr_pv"|default_if_none:"0" }}</b></td>
              <td class="g-green"><b>{{ st.total_data|get_item:"vygr_proch"|default_if_none:"0" }}</b></td>
              <td class="g-green"><b>{{ st.total_data|get_item:"vygr_itogo"|default_if_none:"0" }}</b></td>
              <td class="g-green"><b>{{ st.total_data|get_item:"vygr_itogo_kon"|default_if_none:"0" }}</b></td>

              <td class="g-green"><b>{{ st.total_data|get_item:"pod_vygr_ft"|default_if_none:"0" }}</b></td>
              <td class="g-green"><b>{{ st.total_data|get_item:"pod_vygr_cont"|default_if_none:"0" }}</b></td>
              <td class="g-green"><b>{{ st.total_data|get_item:"pod_vygr_kr"|default_if_none:"0" }}</b></td>
              <td class="g-green"><b>{{ st.total_data|get_item:"pod_vygr_pv"|default_if_none:"0" }}</b></td>
              <td class="g-green"><b>{{ st.total_data|get_item:"pod_vygr_proch"|default_if_none:"0" }}</b></td>
              <td class="g-green"><b>{{ st.total_data|get_item:"pod_vygr_itogo"|default_if_none:"0" }}</b></td>
              <td class="g-green"><b>{{ st.total_data|get_item:"pod_vygr_itogo_kon"|default_if_none:"0" }}</b></td>

              <td class="g-yellow"><b>{{ st.total_data|get_item:"uborka"|default_if_none:"0" }}</b></td>

              <td class="g-blue"><b>{{ st.total_data|get_item:"pogr_ft"|default_if_none:"0" }}</b></td>
              <td class="g-blue"><b>{{ st.total_data|get_item:"pogr_cont"|default_if_none:"0" }}</b></td>
              <td class="g-blue"><b>{{ st.total_data|get_item:"pogr_kr"|default_if_none:"0" }}</b></td>
              <td class="g-blue"><b>{{ st.total_data|get_item:"pogr_pv"|default_if_none:"0" }}</b></td>
              <td class="g-blue"><b>{{ st.total_data|get_item:"pogr_proch"|default_if_none:"0" }}</b></td>
              <td class="g-blue"><b>{{ st.total_data|get_item:"pogr_itogo_kon"|default_if_none:"0" }}</b></td>

              <td class="g-blue"><b>{{ st.total_data|get_item:"pod_pogr_ft"|default_if_none:"0" }}</b></td>
              <td class="g-blue"><b>{{ st.total_data|get_item:"pod_pogr_cont"|default_if_none:"0" }}</b></td>
              <td class="g-blue"><b>{{ st.total_data|get_item:"pod_pogr_kr"|default_if_none:"0" }}</b></td>
              <td class="g-blue"><b>{{ st.total_data|get_item:"pod_pogr_pv"|default_if_none:"0" }}</b></td>
              <td class="g-blue"><b>{{ st.total_data|get_item:"pod_pogr_proch"|default_if_none:"0" }}</b></td>
              <td class="g-blue"><b>{{ st.total_data|get_item:"pod_pogr_itogo_kon"|default_if_none:"0" }}</b></td>

              <td class="g-gray"><b>{{ st.total_data|get_item:"income_daily"|default_if_none:"0" }}</b></td>
            </tr>
            {% endif %}

          {% empty %}
            <tr>
              <td colspan="999" style="padding:16px;" data-i18n="no_data">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ —ç—Ç–æ–π –¥–∞—Ç–µ</td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>

  <div class="t1a-note">
    <span data-i18n="t1_admin_note">
      Izoh: admin panelda ‚Äújami‚Äù maydonlari ‚Äúft+kr+pv+prochee‚Äù bo‚Äòyicha hisoblanadi, ‚Äújami kon‚Äù esa ‚Äúkont.‚Äù ni takrorlaydi
      (bloklar: Tushirish / Tushirishda / Yuklash / Yuklashda).
    </span>
  </div>
</div>

<script>
(function(){
  // ‚úÖ –∫–ª–∏–∫–∞ –ø–æ –≤—Å–µ–π —è—á–µ–π–∫–µ (—á—Ç–æ–±—ã –∫–∞–∫ —É —Ç–µ–±—è –Ω–∞ —Å–∫—Ä–∏–Ω–µ —Ä–∞–±–æ—Ç–∞–ª–æ)
  document.querySelectorAll('td.t1a-name.is-clickable[data-href]').forEach(td=>{
    td.addEventListener('click', (e)=>{
      if (e.target && e.target.closest('a')) return;
      const url = (td.getAttribute('data-href') || '').trim();
      if (!url) return;
      window.location.href = url;
    });
  });
})();
</script>

<script>
(function(){
  const dict = {
    uz: {
      t1_admin_title: "Hisobot ‚Ññ1",
      t1_admin_sub: "Logistika markazlari bo‚Äòyicha operativ ma‚Äôlumot (admin ko‚Äòrish).",
      back_to_list: "Ro‚Äòyxatga qaytish",
      col_lc: "LM nomi",
      col_shift: "Smena",
      shift_day: "kun",
      shift_night: "tun",
      shift_total: "jami",
      no_data: "Ushbu sana bo‚Äòyicha ma‚Äôlumot yo‚Äòq",
      t1_admin_note: "Izoh: admin panelda ‚Äújami‚Äù maydonlari ‚Äúft+kr+pv+–ø—Ä–æ—á–µ–µ‚Äù bo‚Äòyicha hisoblanadi, ‚Äújami kon‚Äù esa ‚Äúkont.‚Äù ni takrorlaydi (bloklar: Tushirish / Tushirishda / Yuklash / Yuklashda).",
      t1_admin_header: "\"O‚Äòztemiryo‚Äòlkonteyner\" AJ logistika markazlari bo‚Äòyicha sutkalik operativ ma‚Äôlumot ‚Äî",
      t1_col_podano: "LMga berildi",
      t1_col_kpod: "St‚Äôdan berishga",
      t1_blk_vygr: "Tushirish",
      t1_blk_pod_vygr: "Tushirishda",
      t1_col_uborka: "Yig‚Äòishtirish",
      t1_blk_pogr: "Yuklash",
      t1_blk_pod_pogr: "Yuklashda",
      t1_col_income: "sutkalik daromad",
      t1_misc: "boshqa",
      t1_itogo: "jami",
      t1_itogo_kon: "jami kon"
    },
    ru: {
      t1_admin_title: "–¢–∞–±–ª–∏—Ü–∞ ‚Ññ1",
      t1_admin_sub: "–û–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∏–º —Ü–µ–Ω—Ç—Ä–∞–º (–∞–¥–º–∏–Ω –ø—Ä–æ—Å–º–æ—Ç—Ä).",
      back_to_list: "–ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É",
      col_lc: "–ù–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –õ–¶",
      col_shift: "–°–º–µ–Ω–∞",
      shift_day: "–¥–µ–Ω—å",
      shift_night: "–Ω–æ—á—å",
      shift_total: "–∏—Ç–æ–≥",
      no_data: "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ —ç—Ç–æ–π –¥–∞—Ç–µ",
      t1_admin_note: "–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –≤ –∞–¥–º–∏–Ω–∫–µ –ø–æ–ª—è ‚Äú–∏—Ç–æ–≥–æ‚Äù —Å—á–∏—Ç–∞—é—Ç—Å—è –∫–∞–∫ ‚Äú—Ñ—Ç+–∫—Ä+–ø–≤+–ø—Ä–æ—á–µ–µ‚Äù, –∞ ‚Äú–∏—Ç–æ–≥–æ –∫–æ–Ω‚Äù –∑–µ—Ä–∫–∞–ª–∏—Ç ‚Äú–∫–æ–Ω—Ç.‚Äù (–¥–ª—è –±–ª–æ–∫–æ–≤: –í—ã–≥—Ä—É–∑–∫–∞ / –ü–æ–¥ –≤—ã–≥—Ä—É–∑–∫–æ–π / –ü–æ–≥—Ä—É–∑–∫–∞ / –ü–æ–¥ –ø–æ–≥—Ä—É–∑–∫–æ–π).",
      t1_admin_header: "–û–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–∞–±–æ—Ç–µ –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö —Ü–µ–Ω—Ç—Ä–æ–≤ –ê–û \"–£–∑—Ç–µ–º–∏—Ä–π—É–ª–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä\" –≤ —Å—É—Ç–∫–∏ ‚Äî",
      t1_col_podano: "–ü–æ–¥–∞–Ω–æ –Ω–∞ –õ–¶",
      t1_col_kpod: "–∫ –ø–æ–¥–∞—á–µ —Å–æ —Å—Ç",
      t1_blk_vygr: "–í—ã–≥—Ä—É–∑–∫–∞",
      t1_blk_pod_vygr: "–ü–æ–¥ –≤—ã–≥—Ä—É–∑–∫–æ–π",
      t1_col_uborka: "–£–±–æ—Ä–∫–∞",
      t1_blk_pogr: "–ü–æ–≥—Ä—É–∑–∫–∞",
      t1_blk_pod_pogr: "–ü–æ–¥ –ø–æ–≥—Ä—É–∑–∫–æ–π",
      t1_col_income: "—Å—É—Ç–æ—á–Ω—ã–µ –¥–æ—Ö–æ–¥—ã",
      t1_misc: "–ø—Ä–æ—á–µ–µ",
      t1_itogo: "–∏—Ç–æ–≥–æ",
      t1_itogo_kon: "–∏—Ç–æ–≥–æ –∫–æ–Ω"
    }
  };

  function getLang(){
    const htmlLang = document.documentElement.getAttribute("data-lang");
    const ls = localStorage.getItem("lang") || localStorage.getItem("ui_lang");
    const lang = (htmlLang || ls || "ru").toLowerCase();
    return (lang === "uz") ? "uz" : "ru";
  }

  function applyLang(){
    const t = dict[getLang()] || dict.ru;
    document.querySelectorAll("[data-i18n]").forEach(el=>{
      const k = el.getAttribute("data-i18n");
      if (t[k] !== undefined) el.textContent = t[k];
    });
  }

  applyLang();
  window.addEventListener("storage", (e)=>{
    if(e.key === "lang" || e.key === "ui_lang") applyLang();
  });
  const mo = new MutationObserver(applyLang);
  mo.observe(document.documentElement, { attributes:true, attributeFilter:["data-lang"] });
})();
</script>

<script>
(function(){
  // 1) Raqamlarni 1 234 567 ko'rinishga keltiradi (ru-RU odatda space/nbsp qo'yadi)
  const fmt = new Intl.NumberFormat('ru-RU'); // xohlasangiz 'uz-UZ' ham bo'ladi

  // 2) Jadval ichidagi hamma td/th larni tekshirib chiqamiz (header emas, faqat body)
  const table = document.getElementById('t1admin');
  if (!table) return;

  table.querySelectorAll('tbody td').forEach(td => {
    // sticky nom/smena ustunlarini tegmaymiz
    if (td.classList.contains('t1a-name') || td.classList.contains('t1a-shift')) return;

    let s = (td.textContent || '').trim();

    // bo'sh / 0 / oddiy matnlarni o'tkazib yuborish uchun:
    // faqat butun sonlar (123456) yoki manfiy (-123) bo'lsa formatlaymiz
    if (!/^-?\d+$/.test(s)) return;

    const n = Number(s);
    if (!Number.isFinite(n)) return;

    td.textContent = fmt.format(n);
  });
})();
</script>

{% endblock %}
