{% extends "base.html" %}

{% block title %}Таблица 1 — Отчёты{% endblock %}

{% block content %}
<div class="card">
  <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap;">
    <h2 style="margin:0;">Таблица №1 — отчёты</h2>

    {# ✅ ВАЖНО: Create ведём на VIEW, а view решит: показать или отправить на edit #}
    <a class="btn"
       href="/station/table-1/view/{{ today }}/"
       style="text-decoration:none;display:inline-flex;align-items:center;">
      Создать отчёт
    </a>
  </div>

  <div class="muted" style="margin-top:8px;">
    Здесь отображаются ваши отчёты. Можно просмотреть, редактировать или удалить.
  </div>

  <table class="tbl" style="margin-top:14px;">
    <thead>
      <tr>
        <th>Дата</th>
        <th>Год</th>
        <th>Отправлено</th>
        <th style="width:360px;">Действия</th>
      </tr>
    </thead>

    <tbody>
      {% for r in rows %}
      <tr>
        <td><b>{{ r.date|date:"d.m.Y" }}</b></td>
        <td>{{ r.year }}</td>
        <td>
          {% if r.submitted_at %}
            {{ r.submitted_at|date:"d.m.Y H:i" }}
          {% else %}
            —
          {% endif %}
        </td>
        <td>
          <div style="display:flex;gap:10px;flex-wrap:wrap;">
            <a class="btn" href="/station/table-1/view/{{ r.date|date:'Y-m-d' }}/" style="text-decoration:none;">Просмотр</a>
            <a class="btn" href="/station/table-1/edit/{{ r.date|date:'Y-m-d' }}/" style="text-decoration:none;">Редактировать</a>

            <form method="post" action="/station/table-1/delete/{{ r.date|date:'Y-m-d' }}/" style="display:inline;">
              {% csrf_token %}
              <button class="btn" type="submit" style="background:#fee2e2;border:1px solid #fecaca;color:#991b1b;">
                Удалить
              </button>
            </form>
          </div>
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="4">Пока нет отчётов. Нажми <b>Создать отчёт</b>.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}
